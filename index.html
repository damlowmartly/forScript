<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Notes & Scripts</title>
<style>
body {margin:0;font-family:Arial,sans-serif;background:#f4f4f4;padding-bottom:100px;}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:15px;padding:20px;}
.card{background:white;border-radius:10px;padding:15px;cursor:pointer;box-shadow:0 4px 10px rgba(0,0,0,0.1);display:flex;align-items:center;justify-content:center;text-align:center;min-height:120px;font-weight:bold;position:relative;overflow:hidden;}
.delete-btn{position:absolute;top:6px;right:8px;background:#ff4d4d;color:white;border:none;border-radius:50%;width:22px;height:22px;font-size:14px;cursor:pointer;line-height:20px;}
.btn-bar{position:fixed;bottom:20px;left:50%;transform:translateX(-50%);display:flex;gap:10px;}
button{padding:12px 22px;border-radius:30px;border:none;background:#333;color:white;cursor:pointer;}
.modal{position:fixed;inset:0;background:rgba(0,0,0,0.7);display:none;align-items:center;justify-content:center;z-index:10;}
.panel{width:90vw;height:90vh;background:white;border-radius:12px;padding:20px;overflow:auto;position:relative;display:flex;}
.close{position:absolute;top:12px;right:15px;cursor:pointer;font-size:20px;}
input,textarea{padding:10px;margin-bottom:10px;}
input[type=file]{padding:3px;}
.note-left{width:20%;margin-right:10px;display:flex;flex-direction:column;}
.note-left textarea{flex:1;}
.note-right{width:80%;display:flex;align-items:center;justify-content:center;}
.note-right img{max-width:100%;max-height:100%;border-radius:8px;object-fit:cover;}
.script-inputs input{margin-bottom:6px;width:100%;}
.result{background:#f1f1f1;padding:15px;border-radius:8px;white-space:pre-wrap;margin-top:10px;flex:1;}
</style>
</head>
<body>

<div class="grid" id="grid"></div>

<div class="btn-bar">
<button onclick="openNote()">Create</button>
<button onclick="openScript()">CreateScript</button>
</div>

<!-- CREATE NOTE (with image) -->
<div class="modal" id="noteModal">
<div class="panel">
<span class="close" onclick="closeAll()">✕</span>
<div class="note-left">
<input id="noteTitle" placeholder="Note title">
<textarea id="noteText" rows="6" placeholder="Write your note"></textarea>
<input type="file" id="noteImage" accept="image/*">
<button onclick="saveNote()">Save</button>
</div>
<div class="note-right">
<img id="notePreview" src="" alt="" />
</div>
</div>
</div>

<!-- CREATE SCRIPT -->
<div class="modal" id="scriptModal">
<div class="panel" style="flex-direction:column;">
<span class="close" onclick="closeAll()">✕</span>
<input id="scriptTitle" placeholder="Script title">
<textarea id="scriptText" rows="8" placeholder="Use placeholders like 1& 2& 3&"></textarea>
<button onclick="saveScript()">Save Script</button>
</div>
</div>

<!-- VIEW SCRIPT -->
<div class="modal" id="viewScriptModal">
<div class="panel" style="flex-direction:column;">
<span class="close" onclick="closeAll()">✕</span>
<div class="script-inputs" id="scriptInputs"></div>
<button onclick="saveValues()">Save Values</button>
<div class="result" id="scriptResult"></div>
</div>
</div>

<script>
const grid=document.getElementById("grid");
let items=JSON.parse(localStorage.getItem("items"))||[];
let activeScriptIndex=null;

// PREVIEW IMAGE
const notePreview=document.getElementById("notePreview");
document.getElementById("noteImage").addEventListener("change",function(e){
if(this.files && this.files[0]){
const reader=new FileReader();
reader.onload=function(ev){notePreview.src=ev.target.result;}
reader.readAsDataURL(this.files[0]);
}
});

// RENDER GRID
function render(){
grid.innerHTML="";
items.forEach((item,i)=>{
const div=document.createElement("div");
div.className="card";
div.innerText=item.title;
div.onclick=()=>{
if(item.type==="script") openScriptView(i);
else openNoteView(i);
};
// delete
const del=document.createElement("button");
del.className="delete-btn";
del.innerText="✕";
del.onclick=e=>{
e.stopPropagation();
if(confirm("Delete this item?")){
items.splice(i,1);
localStorage.setItem("items",JSON.stringify(items));
render();
}
};
div.appendChild(del);
grid.appendChild(div);
});
}
render();

// MODALS
function openNote(){noteModal.style.display="flex";}
function openScript(){scriptModal.style.display="flex";}
function closeAll(){document.querySelectorAll(".modal").forEach(m=>m.style.display="none");}

// SAVE NOTE WITH IMAGE
function saveNote(){
const fileInput=document.getElementById("noteImage");
let imgData="";
if(fileInput.files && fileInput.files[0]){
const reader=new FileReader();
reader.onload=function(ev){
imgData=ev.target.result;
pushNote(imgData);
};
reader.readAsDataURL(fileInput.files[0]);
}else pushNote("");
function pushNote(img){
items.push({type:"note",title:noteTitle.value,text:noteText.value,image:img});
localStorage.setItem("items",JSON.stringify(items));
closeAll();render();
notePreview.src="";
noteTitle.value="";noteText.value="";fileInput.value="";
}
}

// VIEW NOTE
function openNoteView(index){
const note=items[index];
alert(note.title+"\n\n"+note.text); // simple alert, can expand later
}

// SAVE SCRIPT
function saveScript(){
if(!scriptTitle.value||!scriptText.value)return;
items.push({type:"script",title:scriptTitle.value,template:scriptText.value,values:{}});
localStorage.setItem("items",JSON.stringify(items));
closeAll();render();
}

// VIEW SCRIPT
function openScriptView(index){
activeScriptIndex=index;
const script=items[index];
const inputsDiv=document.getElementById("scriptInputs");
const resultDiv=document.getElementById("scriptResult");
inputsDiv.innerHTML="";
let values=script.values||{};
const matches=[...script.template.matchAll(/\b([1-9]|10)&/g)].map(m=>m[1]).filter((v,i,a)=>a.indexOf(v)===i);
matches.forEach(n=>{
const input=document.createElement("input");
input.placeholder=`Value for ${n}&`;
input.value=values[n]||"";
input.oninput=()=>{
values[n]=input.value;
updateResult(script.template,values);
};
inputsDiv.appendChild(input);
});
updateResult(script.template,values);
viewScriptModal.style.display="flex";
}

// UPDATE PREVIEW
function updateResult(template,values){
let output=template;
Object.keys(values).forEach(k=>{output=output.replaceAll(`${k}&`,values[k]);});
document.getElementById("scriptResult").innerText=output;
}

// SAVE VALUES PERSISTENTLY
function saveValues(){
if(activeScriptIndex===null)return;
const script=items[activeScriptIndex];
const inputs=document.querySelectorAll("#scriptInputs input");
const values={};
inputs.forEach(input=>{
const key=input.placeholder.match(/\d+/)[0];
values[key]=input.value;
});
script.values=values;
localStorage.setItem("items",JSON.stringify(items));
alert("Values saved! ✅ They will auto-fill next time.");
}
</script>
</body>
</html>
